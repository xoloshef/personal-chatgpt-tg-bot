# personal-chatgpt-tg-bot

–ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π LLM (OpenAI / OpenAI-compatible API), –ø–ª–∞–≥–∏–Ω–æ–≤ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ –∞—É–¥–∏–æ –∏–∑ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.  
–°–æ–∑–¥–∞–Ω–æ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏: https://github.com/n3d1117/chatgpt-telegram-bot

---
## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ß–∞—Ç
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ (—Ö—Ä–∞–Ω–∏—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (MAX_HISTORY_SIZE=5))
- –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
- Streaming-–æ—Ç–≤–µ—Ç—ã (—Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ –º–µ—Ä–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)

### –ü–ª–∞–≥–∏–Ω—ã (bot/plugins)
–ë–æ—Ç —É–º–µ–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ OpenAI function calling:

- üîé –í–µ–±-–ø–æ–∏—Å–∫ –∏ –ø–æ–∏—Å–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (DuckDuckGo)
- üéµ  –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≤–∏–¥–µ–æ YouTube (OpenAI Whisper)
- üéµ  –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è  –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è Telegram (OpenAI Whisper)
- üß† –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (WolframAlpha)
- üå§ –ü–æ–≥–æ–¥–∞ (Open-Meteo)
- üïí –í—Ä–µ–º—è –∏ —Ç–∞–π–º–∑–æ–Ω—ã
- üìà –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã
- –ü–µ—Ä–µ–≤–æ–¥—ã (DeepL)

---
### üéô –ê—É–¥–∏–æ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **voice / audio / video / video note**
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ `ffmpeg`
- –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenAI Whisper
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç LLM –ø–æ —Ç–µ–∫—Å—Ç—É —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
- –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å–µ–∫—É–Ω–¥ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏

---
### –û—Ç—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å–µ–∫—É–Ω–¥ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –±—é–¥–∂–µ—Ç ()
- –õ–æ–≥–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `usage_logs/`—ç
- –ö–æ–º–∞–Ω–¥–∞ (`/stats`)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ telegram_bot.py      # Telegram handlers –∏ –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ openai_helper.py     # –†–∞–±–æ—Ç–∞ —Å LLM –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ plugin_manager.py    # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–∑–æ–≤ –ø–ª–∞–≥–∏–Ω–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ usage_tracker.py     # –£—á—ë—Ç –ª–∏–º–∏—Ç–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ utils.py             # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ plugins/             # –ü–ª–∞–≥–∏–Ω—ã
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ requirements-minimal.txt
‚îú‚îÄ‚îÄ translations.json
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ usage_logs/
```

---

## –°—Ç–∞—Ä—Ç - Start 

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞  –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω—É–≥–æ —Ñ–∞–π–ª–∞ `.env.example.md`
#### 1.1 –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –¥–ª—è telegram –±–æ—Ç–∞
–ù–∞–ø–∏—Å–∞—Ç—å t.me/BotFather @BotFather
1)  `/start`
2)  `/newbot`
	C–ª–µ–¥—É–µ—Ç–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ @BotFather
3) –ó–∞–¥–∞–π—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –±–æ—Ç–∞ (–ü—Ä–∏–º–µ—Ä: `ChatGPT_bot`)
4) –ó–∞–¥–∞–π—Ç–µ username (–ü—Ä–∏–º–µ—Ä: `ChatGPT_123456_bot`)
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è:
5) –û–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º (–ü—Ä–∏–º–µ—Ä t.me / `ChatGPT_123456_bot`)
6) –°–∫–æ–ø–∏—Ä—É–π—Ç–µ API –∫–ª—é—á (–ü–æ—Å–ª–µ `Use this token to access the HTTP API:`
7) –°–∫–æ–ø–∏—Ä—É–π—Ç–µ API –∫–ª—é—á –≤ `.env.example.md`
	–ú–µ—Å—Ç–æ–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ (`/personal-chatgpt-tg-bot/.env.example.md`)
	–ù–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç 
	```markdown
	4 # Your Telegram bot token obtained using @BotFather
	5 TELEGRAM_BOT_TOKEN=XXX
	```
8) –ó–∞–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `YOUR_OPENAI_API_KEY_HERE` –Ω–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∫–ª—é—á –∏–∑ —Ç–µ–ª–µ–≥—Ä–∞–º  (–ø—É–Ω–∫—Ç 6)
	–ü—Ä–∏–º–µ—Ä :
	```markdown
	4 # Your Telegram bot token obtained using @BotFather
	5 TELEGRAM_BOT_TOKEN='87654321:AAAA...'
	```
#### 1.2 –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –æ—Ç ChatGPT 
1) –í–æ–π–¥–∏—Ç–µ –≤ —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å openai.com
2) –ü–µ—Ä–µ–π—Ç–∏ openai.com --> platform -- > –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é, —Ä–∞–∑–¥–µ–ª Manage --> API keys
	https://platform.openai.com/api-keys
3) –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—é `Create new secret key`
4) –°–æ–∑–¥–∞—Ç—å `Create secret key`
5) –°–∫–æ–ø–∏—Ä—É–π—Ç–µ API –∫–ª—é—á –≤ `.env.example.md`
	–ú–µ—Å—Ç–æ–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ (`/personal-chatgpt-tg-bot/.env.example.md`)
	–ù–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç 
	```markdown
	1 # Your OpenAI API key
	2 OPENAI_API_KEY=YOUR_OPENAI_API_KEY_HERE
	```
6) –ó–∞–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `YOUR_OPENAI_API_KEY_HERE` –Ω–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∫–ª—é—á –∏–∑ —Ç–µ–ª–µ–≥—Ä–∞–º  (–ø—É–Ω–∫—Ç 6)
	–ü—Ä–∏–º–µ—Ä :
	```markdown
	1 # Your OpenAI API key
	2 OPENAI_API_KEY='AAAA...'
	```

####  1.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `.env`
‚ö†Ô∏è **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç–µ .env –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.**
1) –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `.env.example.md`
```markdown
#OpenAI API key
OPENAI_API_KEY='XXX' # —Å–º –ø—É–Ω–∫—Ç 1.2 API –∫–ª—é—á –æ—Ç ChatGPT

#Telegram bot token obtained using @BotFather
TELEGRAM_BOT_TOKEN='XXX' # —Å–º –ø—É–Ω–∫—Ç 1.1 API –∫–ª—é—á –¥–ª—è telegram –±–æ—Ç–∞

# Telegram user ID of admins, or - to assign no admin
ADMIN_USER_IDS=XXX # –≤–∞—à id telegram –∞–∫–∞—É–Ω—Ç–∞ –ø—Ä–∏–º–µ—Ä 11...

# Comma separated list of telegram user IDs, or * to allow all
ALLOWED_TELEGRAM_USER_IDS=XXX  # –≤–∞—à id telegram –∞–∫–∞—É–Ω—Ç–∞ –ø—Ä–∏–º–µ—Ä 11...

MAX_TOKENS=600
MAX_HISTORY_SIZE=5
BOT_LANGUAGE=ru
VISION_MODEL="gpt-4o-mini"
OPENAI_MODEL=gpt-4o-mini
```

2) –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª `.env.example.md` –≤ `.env`
#### 1.4 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - –°—Ç–∞—Ä—Ç

```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python bot/main.py
```

---
